{{ define "main" }}
  {{ $events := sort site.Data.events "start" "asc" }}
  {{ $next := cond (gt (len $events) 0) (index $events 0) nil }}

  <section class="hero hero-image home-hero fade-in">
    <img class="hero-bg" src="/images/three_champs.jpg" alt="Three aircraft flying in formation over a snowy field">
    <div class="container hero-content">
      <h1>This is where aviation lives in Rockford.</h1>
      <p>Since 1957, Cottonwood has brought pilots, builders, families, and future aviators together to fly, learn, and belong.</p>
      <div class="cta-row">
        <a class="button primary" href="/events/">Come Fly With Us</a>
        <a class="button secondary" href="/programs/">Explore Programs</a>
        <a class="button secondary" href="/donate/">Donate</a>
      </div>
    </div>
  </section>

  <section class="container section fade-in home-why">
    <h2>Why people come here</h2>
    <div class="grid programs">
      <article class="card">
        <h3>Fly</h3>
        <p>From local fly-ins to chapter nights, pilots find an active field and a community that shows up.</p>
      </article>
      <article class="card">
        <h3>Learn</h3>
        <p>Ground school, safety conversations, and hands-on projects keep aviation practical and approachable.</p>
      </article>
      <article class="card">
        <h3>Belong</h3>
        <p>New to aviation or lifelong pilot, you’ll find mentors, friendships, and a place to contribute.</p>
      </article>
    </div>
  </section>

  <section class="container section fade-in">
    <h2>Next Up</h2>
    {{ with $next }}
      <article class="card">
        <h3><a href="/events/{{ .slug }}/">{{ .title }}</a></h3>
        <p class="meta">
          {{ if .allDay }}
            {{ time .start | time.Format "Mon, Jan 2" }} • All day
          {{ else }}
            {{ time .start | time.Format "Mon, Jan 2 • 3:04 PM" }}
          {{ end }}
          {{ with .location }} • {{ . }}{{ end }}
        </p>
        <p class="meta">Click below for details.</p>
        <div class="cta-row">
          <a class="button primary" href="/events/{{ .slug }}/">Details</a>
          <a class="button secondary" href="{{ .icsPath }}">Add to Calendar (.ics)</a>
        </div>
      </article>
    {{ else }}
      <article class="card">
        <h3>No upcoming events found yet.</h3>
        <p class="meta">Calendar sync may still be running. Please check back soon.</p>
      </article>
    {{ end }}
  </section>

  <section class="container section fade-in">
    <h2>What we do</h2>
    <div class="grid programs">
      <article class="card">
        <h3>Young Eagles</h3>
        <p>Inspiring youth through introductory flights and aviation mentorship.</p>
        <a href="/programs/young-eagles/">Learn more →</a>
      </article>
      <article class="card">
        <h3>Pilot Ground School</h3>
        <p>Accessible, community-driven learning for future and current pilots.</p>
        <a href="/programs/pilot-ground-school/">Learn more →</a>
      </article>
      <article class="card">
        <h3>Fly-ins & Events</h3>
        <p>Regular chapter meetups, hangar talks, and field-friendly social events.</p>
        <a href="/events/">View events →</a>
      </article>
      <article class="card">
        <h3>Community</h3>
        <p>Volunteerism, outreach, and aviation camaraderie across Cottonwood.</p>
        <a href="/about/">Our mission →</a>
      </article>
    </div>
  </section>

  <section class="container section fade-in">
    <h2>Life at Cottonwood</h2>
    <div class="photo-strip">
      {{ $photos := slice }}
      {{ with site.Data.photos }}
        {{ with .photos }}
          {{ $photos = . }}
        {{ end }}
      {{ end }}

      {{ if gt (len $photos) 0 }}
        {{ range first 6 $photos }}
          <img src="{{ .src }}" alt="{{ .alt }}" loading="lazy">
        {{ end }}
      {{ else }}
        <img src="/images/photo-1.svg" alt="Chapter members at the airport" loading="lazy">
        <img src="/images/photo-2.svg" alt="Aircraft parked on ramp" loading="lazy">
        <img src="/images/photo-3.svg" alt="Young Eagles program day" loading="lazy">
      {{ end }}
    </div>
  </section>
{{ end }}
